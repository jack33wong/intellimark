
> intellimark-chat-backend@1.0.0 dev
> cross-env NODE_OPTIONS=--no-deprecation nodemon --exec tsx --tsconfig tsconfig.dev.json server.ts

üìö Swagger UI available at: http://localhost:5001/api-docs
üîç [CLASSIFICATION DEBUG] Raw cleanContent: {
  "isQuestionOnly": false,
  "reasoning": "The image contains the math question along with calculations and the final answer, which constitutes student work.",
  "extractedQuestionText": "Here are t...
üîç [CLASSIFICATION DEBUG] Full Gemini result: {
  "candidates": [
    {
      "content": {
        "parts": [
          {
            "text": "{\n  \"isQuestionOnly\": false,\n  \"reasoning\": \"The image contains the math question along with calculations and the final answer, which constitutes student work.\",\n  \"extractedQuestionText\": \"Here are the first four terms of a quadratic sequence.\\n3 20 47 84\\nWork out an expression for the nth term of the sequence.\"\n}"
          }
        ],
        "role": "model"
      },
      "finishReason": "STOP",
      "index": 0
    }
  ],
  "usageMetadata": {
    "promptTokenCount": 571,
    "candidatesTokenCount": 82,
    "totalTokenCount": 967,
    "promptTokensDetails": [
      {
        "modality": "TEXT",
        "tokenCount": 313
      },
      {
        "modality": "IMAGE",
        "tokenCount": 258
      }
    ],
    "thoughtsTokenCount": 314
  },
  "modelVersion": "gemini-2.5-flash",
  "responseId": "KPjwaLj3OZSokdUP8J3xyQY"
}
[1/7] Image Analysis            [0.3s] [google-vision]
[2/7] Image Classification      [4.4s] [gemini-2.5-flash]
üìù [MODE] Marking mode detected - using full pipeline
