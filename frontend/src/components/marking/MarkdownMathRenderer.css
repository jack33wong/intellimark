/* --- Final CSS with KaTeX line-height Fix --- */

.markdown-math-renderer {
  padding: 0px 25px 0px;
  line-height: 1.8;
  color: var(--text-primary);
}

.markdown-p,
.markdown-ol,
ul {
  margin: 0.5em 0;
  line-height: 1.6; /* This is good for text, but bad for KaTeX */
}

/* --- Title & Indentation --- */
.markdown-math-renderer h3 {
  color: var(--text-primary);
  font-weight: 500;
  margin: 0.5em 0 0.5em 0;
  font-size: 1.1em;
}

.markdown-math-renderer h3 ~ .markdown-p,
.markdown-math-renderer h3 ~ .markdown-ol,
.markdown-math-renderer h3 ~ ul {
  margin-left: 1.5em;
}

/* --- List Styling --- */
.markdown-math-renderer .markdown-ol,
.markdown-math-renderer ul {
  list-style-position: outside;
  padding-left: 1.5em;
}

/* --- Final Answer Section --- */
.markdown-math-renderer > p:last-of-type {
  border-top: 1px solid var(--text-tertiary, #cccccc);
  padding: 1em;
  margin-top: 1em;
  margin-left: 0;
}

/* --- Math and Variable Styling --- */

/* Style ONLY the simple variables */
.markdown-math-renderer .markdown-em {
  color: var(--function-error);
  font-style: normal;
}

/* Style ONLY the KaTeX blocks */
.markdown-math-renderer .katex {
  padding: 0.2em;
  background: var(--background-card);
  color: var(--function-error);
  line-height: initial; /* FIX: This protects KaTeX from the global line-height */
}